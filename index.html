<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search, Composite, and Download Google Earth Engine Imagery with the Python Module geedim • rgeedim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Search, Composite, and Download Google Earth Engine Imagery with the Python Module geedim">
<meta property="og:description" content='Search, composite, and download Google Earth Engine imagery with reticulate bindings for the Python module geedim by Dugal Harris. Read the geedim documentation here: &lt;https://geedim.readthedocs.io/&gt;. Wrapper functions are provided to make it more convenient to use geedim to download images larger than the Google Earth Engine size limit &lt;https://developers.google.com/earth-engine/apidocs/ee-image-getdownloadurl&gt;. By default the "High Volume" API endpoint &lt;https://developers.google.com/earth-engine/cloud/highvolume&gt; is used to download data and this URL can be customized during initialization of the package.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rgeedim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/daymet_example.html">Daymet Example</a>
    </li>
    <li>
      <a href="articles/demo.html">`rgeedim` Demo</a>
    </li>
    <li>
      <a href="articles/ee_export_example.html">Earth Engine Export Example</a>
    </li>
    <li>
      <a href="articles/ee_vect_asset.html">Earth Engine Vector Asset Example</a>
    </li>
    <li>
      <a href="articles/hillshade_example.html">Hillshade Example</a>
    </li>
    <li>
      <a href="articles/landsat_example.html">Landsat Example</a>
    </li>
    <li>
      <a href="articles/lidar_example.html">LiDAR Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brownag/rgeedim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="rgeedim">{rgeedim}<a class="anchor" aria-label="anchor" href="#rgeedim"></a>
</h1></div>
<!-- badges: start -->

<p>{rgeedim} supports search and download of Google Earth Engine imagery with Python module <a href="https://github.com/leftfield-geospatial/geedim" class="external-link"><code>geedim</code></a> by Dugal Harris. This package provides wrapper functions that make it more convenient to use <code>geedim</code> from R.</p>
<p>The <a href="https://humus.rocks/rgeedim/" class="external-link">rgeedim manual</a> describes the R API. See the <a href="https://geedim.readthedocs.io/" class="external-link">geedim manual</a> for more information on Python API and command line interface.</p>
<p>Using <code>geedim</code>, images larger than the <a href="https://developers.google.com/earth-engine/apidocs/ee-image-getdownloadurl" class="external-link"><code>Image.getDownloadURL()</code> size limit</a> are split and downloaded as separate tiles, then re-assembled into a single GeoTIFF.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>{rgeedim} is available on CRAN, and can be installed as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rgeedim"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of {rgeedim} using {remotes}:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"brownag/rgeedim"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-rgeedim-works">How {rgeedim} Works<a class="anchor" aria-label="anchor" href="#how-rgeedim-works"></a>
</h2>
<p>{rgeedim} uses the <code>geedim</code> and <code>earthengine-api</code> Python modules via {reticulate}. If you do not have Python installed on your computer you can use <code><a href="https://rstudio.github.io/reticulate/reference/install_python.html" class="external-link">reticulate::install_python()</a></code> to download and set up a Python binary and virtual environment.</p>
<p>If you are running {rgeedim} interactively for the first time you may be prompted to create a default Python environment called <code>"r-reticulate"</code> for {reticulate} to use. Select ‘Yes’ at the prompt. If you select ‘No’ you will need to manually configure a Python environment. {rgeedim} provides a helper function, <code><a href="reference/gd_install.html">gd_install()</a></code>, to facilitate installing the required Python dependencies.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://humus.rocks/rgeedim/" class="external-link">rgeedim</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>You will need Python 3 with the <code>geedim</code> module installed to use {rgeedim}.</p>
<div class="section level4">
<h4 id="using-gd_install">Using <code>gd_install()</code>
<a class="anchor" aria-label="anchor" href="#using-gd_install"></a>
</h4>
<p><code><a href="reference/gd_install.html">gd_install()</a></code> provides a simple wrapper around <code><a href="https://rstudio.github.io/reticulate/reference/py_install.html" class="external-link">reticulate::py_install()</a></code> that allows you to install dependencies using <code>pip</code>, virtual, or Conda environments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install with pip (with reticulate)</span></span>
<span><span class="fu"><a href="reference/gd_install.html">gd_install</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># install with pip (system() call)</span></span>
<span><span class="fu"><a href="reference/gd_install.html">gd_install</a></span><span class="op">(</span>system <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use virtual environment with default name "r-rgeedim"</span></span>
<span><span class="fu"><a href="reference/gd_install.html">gd_install</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"virtualenv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use "conda" environment named "foo"</span></span>
<span><span class="fu"><a href="reference/gd_install.html">gd_install</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"conda"</span>, envname <span class="op">=</span> <span class="st">"foo"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="using-pip">Using <code>pip</code>
<a class="anchor" aria-label="anchor" href="#using-pip"></a>
</h4>
<p>You can install <code>geedim</code> with <code>pip</code>, for example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> pip install geedim</span></code></pre></div>
<p>This shell command assumes you have a Python 3 executable named (or aliased) as <code>python</code> on your PATH, or the command is being called from within an active Python virtual environment.</p>
</div>
<div class="section level3">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h3>
<p>If using Python within RStudio, you may need to set your default interpreter in <em>Tools</em> &gt;&gt; <em>Global Options…</em> &gt;&gt; <em>Python</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="authentication--initialization">Authentication &amp; Initialization<a class="anchor" aria-label="anchor" href="#authentication--initialization"></a>
</h2>
<p>If this is your first time using any Google Earth Engine tools, authenticate with <code><a href="reference/gd_authenticate.html">gd_authenticate()</a></code>. You can pass arguments to use several different authorization methods.</p>
<p>Perhaps the easiest to use is <code>auth_mode="notebook"</code> since it does not rely on an existing <code>GOOGLE_APPLICATION_CREDENTIALS</code> file nor an installation of the <code>gcloud</code> CLI tools. However, the other options (using <code>gcloud</code> or a service account) are better for non-interactive or long-term use.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># short duration token</span></span>
<span><span class="fu"><a href="reference/gd_authenticate.html">gd_authenticate</a></span><span class="op">(</span>auth_mode <span class="op">=</span> <span class="st">"notebook"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># longer duration (default); requires gcloud command-line tools</span></span>
<span><span class="fu"><a href="reference/gd_authenticate.html">gd_authenticate</a></span><span class="op">(</span>auth_mode <span class="op">=</span> <span class="st">"gcloud"</span><span class="op">)</span></span></code></pre></div>
<p>In each R session you will need to initialize the Earth Engine library.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GOOGLE_CLOUD_QUOTA_PROJECT"</span>, <span class="st">"rgeedim-demo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/gd_initialize.html">gd_initialize</a></span><span class="op">(</span>project <span class="op">=</span> <span class="va">project_id</span><span class="op">)</span></span></code></pre></div>
<p>Note that with <code>auth_mode="gcloud"</code> you need to specify the project via <code>project=</code> argument, in your default configuration file or via system environment variable <code>GOOGLE_CLOUD_QUOTA_PROJECT</code>. The authorization tokens generated for <code>auth_mode="notebook"</code> are always associated with a specific project.</p>
<p>Once initialized you can select an extent of interest. <code><a href="reference/gd_bbox.html">gd_bbox()</a></code> is a simple function for specifying extents to {rgeedim} functions like <code><a href="reference/gd_download.html">gd_download()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gd_bbox.html">gd_bbox</a></span><span class="op">(</span></span>
<span>  xmin <span class="op">=</span> <span class="op">-</span><span class="fl">120.6032</span>,</span>
<span>  xmax <span class="op">=</span> <span class="op">-</span><span class="fl">120.5377</span>,</span>
<span>  ymin <span class="op">=</span> <span class="fl">38.0807</span>,</span>
<span>  ymax <span class="op">=</span> <span class="fl">38.1043</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We will download the US NED CHILI (Continuous Heat-Insolation Load Index) <a href="https://developers.google.com/earth-engine/datasets/catalog/CSP_ERGo_1_0_US_CHILI" class="external-link uri">https://developers.google.com/earth-engine/datasets/catalog/CSP_ERGo_1_0_US_CHILI</a>. We specify an equal-area coordinate reference system (NAD83 Albers), bilinear resampling, and a resolution of 10 meters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">'CSP/ERGo/1_0/US/CHILI'</span> <span class="op">|&gt;</span></span>
<span>          <span class="fu"><a href="reference/from.html">gd_image_from_id</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>          <span class="fu"><a href="reference/gd_download.html">gd_download</a></span><span class="op">(</span></span>
<span>            filename <span class="op">=</span> <span class="st">'image.tif'</span>,</span>
<span>            region <span class="op">=</span> <span class="va">r</span>,</span>
<span>            crs <span class="op">=</span> <span class="st">"EPSG:5070"</span>,</span>
<span>            resampling <span class="op">=</span> <span class="st">"bilinear"</span>,</span>
<span>            scale <span class="op">=</span> <span class="fl">10</span>, <span class="co"># scale=10: request ~10m resolution</span></span>
<span>            overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p>We can inspect our results with {terra}. The resulting GeoTIFF has two layers, <code>"constant"</code> and <code>"FILL_MASK"</code>. The former contains the data, and the latter contains a mask reflecting data availability (value = 1 where data are available).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">f</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-hillshade-from-dem">Example: Hillshade from DEM<a class="anchor" aria-label="anchor" href="#example-hillshade-from-dem"></a>
</h2>
<p>This example demonstrates the download of a section of the USGS NED seamless 10m grid. This DEM is processed locally with {terra} to calculate some terrain derivatives (slope, aspect) and a hillshade.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://humus.rocks/rgeedim/" class="external-link">rgeedim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/gd_initialize.html">gd_initialize</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"rgeedim-demo"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gd_bbox.html">gd_bbox</a></span><span class="op">(</span></span>
<span>  xmin <span class="op">=</span> <span class="op">-</span><span class="fl">120.296</span>,</span>
<span>  xmax <span class="op">=</span> <span class="op">-</span><span class="fl">120.227</span>,</span>
<span>  ymin <span class="op">=</span> <span class="fl">37.9824</span>,</span>
<span>  ymax <span class="op">=</span> <span class="fl">38.0071</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## hillshade example</span></span>
<span><span class="co"># download 10m NED DEM in AEA</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"USGS/SRTMGL1_003"</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/from.html">gd_image_from_id</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_download.html">gd_download</a></span><span class="op">(</span></span>
<span>    region <span class="op">=</span> <span class="va">b</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    crs <span class="op">=</span> <span class="st">"EPSG:5070"</span>,</span>
<span>    resampling <span class="op">=</span> <span class="st">"bilinear"</span>,</span>
<span>    filename <span class="op">=</span> <span class="st">"image.tif"</span>,</span>
<span>    bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"elevation"</span><span class="op">)</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">elevation</span></span>
<span></span>
<span><span class="co"># calculate slope, aspect, and hillshade with terra</span></span>
<span><span class="va">slp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">dem</span>, <span class="st">"slope"</span>, unit <span class="op">=</span> <span class="st">"radians"</span><span class="op">)</span></span>
<span><span class="va">asp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">dem</span>, <span class="st">"aspect"</span>, unit <span class="op">=</span> <span class="st">"radians"</span><span class="op">)</span></span>
<span><span class="va">hsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/shade.html" class="external-link">shade</a></span><span class="op">(</span><span class="va">slp</span>, <span class="va">asp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare elevation vs. hillshade</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dem</span>, hillshade <span class="op">=</span> <span class="va">hsd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Subsets of the <code>"USGS/SRTMGL1_003"</code> image result in multi-band GeoTIFF with <code>"elevation"</code> and <code>"FILL_MASK"</code> bands. In the contiguous US we know the DEM is continuous so the <code>FILL_MASK</code> is not that useful. With geedim &gt;1.7 we retrieve only the <code>"elevation"</code> band by specifying argument <code>bands = list("elevation")</code>. This cuts the raw image size that we need to download in half.</p>
</div>
<div class="section level2">
<h2 id="example-lidar-slope-map">Example: LiDAR Slope Map<a class="anchor" aria-label="anchor" href="#example-lidar-slope-map"></a>
</h2>
<p>This example demonstrates how to access 1-meter LiDAR data from the USGS 3D Elevation Program (3DEP).</p>
<p>There are other methods to derive an area of interest from existing spatial data sources, here we use <code><a href="reference/gd_region.html">gd_region()</a></code> on a SpatVector object and pass resulting object to several functions that require a processing extent.</p>
<p>LiDAR data are not available everywhere, and are generally available as collections of (tiled) layers. Therefore we use <code><a href="reference/gd_search.html">gd_search()</a></code> to narrow down the options. The small sample extent covers only one tile. Additional filters on date and data quality are also possible with <code><a href="reference/gd_search.html">gd_search()</a></code>. A key step in this process is the use of <code><a href="reference/gd_composite.html">gd_composite()</a></code> to resample the component images of interest from the collection on the server-side.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://humus.rocks/rgeedim/" class="external-link">rgeedim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># search and download from USGS 1m lidar data collection</span></span>
<span><span class="fu"><a href="reference/gd_initialize.html">gd_initialize</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"rgeedim-demo"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># wkt-&gt;SpatVector-&gt;GeoJSON</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="st">'POLYGON((-121.355 37.56,-121.355 37.555,</span></span>
<span><span class="st">          -121.35 37.555,-121.35 37.56,</span></span>
<span><span class="st">          -121.355 37.56))'</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="st">"OGC:CRS84"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a GeoJSON-like list from a SpatVector object</span></span>
<span><span class="co"># (most rgeedim functions arguments for spatial inputs do this automatically)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gd_region.html">gd_region</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># search collection for an area of interest</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="st">"USGS/3DEP/1m"</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/from.html">gd_collection_from_name</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_search.html">gd_search</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">r</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># inspect individual image metadata in the collection</span></span>
<span><span class="fu"><a href="reference/gd_properties.html">gd_properties</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># resampling images as part of composite; before download</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_composite.html">gd_composite</a></span><span class="op">(</span>resampling <span class="op">=</span> <span class="st">"bilinear"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/gd_download.html">gd_download</a></span><span class="op">(</span>region <span class="op">=</span> <span class="va">r</span>,</span>
<span>              crs <span class="op">=</span> <span class="st">"EPSG:5070"</span>,</span>
<span>              scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              filename <span class="op">=</span> <span class="st">"image.tif"</span>,</span>
<span>              bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"elevation"</span><span class="op">)</span>,</span>
<span>              overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inspect</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">elevation</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">x</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-landsat-7-cloudshadow-free-composite">Example: Landsat-7 cloud/shadow-free composite<a class="anchor" aria-label="anchor" href="#example-landsat-7-cloudshadow-free-composite"></a>
</h2>
<p>This example demonstrates download of a Landsat-7 cloud/shadow-free composite image. A collection is created from the NASA/USGS Landsat 7 Level 2, Collection 2, Tier 1.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://humus.rocks/rgeedim/" class="external-link">rgeedim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/gd_initialize.html">gd_initialize</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"rgeedim-demo"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gd_bbox.html">gd_bbox</a></span><span class="op">(</span></span>
<span>  xmin <span class="op">=</span> <span class="op">-</span><span class="fl">120.296</span>,</span>
<span>  xmax <span class="op">=</span> <span class="op">-</span><span class="fl">120.227</span>,</span>
<span>  ymin <span class="op">=</span> <span class="fl">37.9824</span>,</span>
<span>  ymax <span class="op">=</span> <span class="fl">38.0071</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## landsat example</span></span>
<span><span class="va">basepath</span> <span class="op">&lt;-</span> <span class="st">'LANDSAT/LE07/C02/T1_L2'</span></span>
<span></span>
<span><span class="co"># search collection for date range and minimum data fill (85%)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">basepath</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/from.html">gd_collection_from_name</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_search.html">gd_search</a></span><span class="op">(</span></span>
<span>    start_date <span class="op">=</span> <span class="st">'2020-11-01'</span>,</span>
<span>    end_date <span class="op">=</span> <span class="st">'2021-02-28'</span>,</span>
<span>    region <span class="op">=</span> <span class="va">b</span>,</span>
<span>    cloudless_portion <span class="op">=</span> <span class="fl">85</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># inspect individual image metadata in the collection</span></span>
<span><span class="fu"><a href="reference/gd_properties.html">gd_properties</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download a single image, no compositing</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">basepath</span>, <span class="st">"/"</span>, <span class="fu"><a href="reference/gd_properties.html">gd_properties</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/from.html">gd_image_from_id</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_download.html">gd_download</a></span><span class="op">(</span></span>
<span>    filename <span class="op">=</span> <span class="st">"image.tif"</span>,</span>
<span>    region <span class="op">=</span> <span class="va">b</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    crs <span class="op">=</span> <span class="st">'EPSG:5070'</span>,</span>
<span>    dtype <span class="op">=</span> <span class="st">'uint16'</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Now we have several images of interest, and also major issues with some of the inputs. In this case there were failures of sensors on the Landsat satellite, but other data gaps may occur due to masked cloudy areas or due to patchy coverage of the source product.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create composite landsat image near December 1st, 2020 and download  </span></span>
<span><span class="co"># using q-mosaic method. </span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/gd_composite.html">gd_composite</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"q-mosaic"</span>,</span>
<span>    date <span class="op">=</span> <span class="st">'2020-12-01'</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/gd_download.html">gd_download</a></span><span class="op">(</span></span>
<span>    filename <span class="op">=</span> <span class="st">"image.tif"</span>,</span>
<span>    region <span class="op">=</span> <span class="va">b</span>,</span>
<span>    scale <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    crs <span class="op">=</span> <span class="st">'EPSG:5070'</span>,</span>
<span>    dtype <span class="op">=</span> <span class="st">'uint16'</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    silent <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The <code>"q-mosaic"</code> method produces a composite largely free of artifacts; this is because it prioritizes pixels with higher distance from clouds to fill in the gaps. Other methods are available such as <code>"medoid"</code>; this may give better results when compositing more contrasting inputs such as several dates over a time period where vegetation or other cover changes appreciably.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rgeedim" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/brownag/rgeedim/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/brownag/rgeedim/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rgeedim</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Andrew Brown <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/brownag/rgeedim/actions" class="external-link"><img src="https://github.com/brownag/rgeedim/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://humus.rocks/rgeedim/" class="external-link"><img src="https://img.shields.io/badge/docs-HTML-informational" alt="HTML Docs"></a></li>
<li><a href="https://app.codecov.io/gh/brownag/rgeedim" class="external-link"><img src="https://codecov.io/gh/brownag/rgeedim/branch/main/graph/badge.svg?token=BYBKW7PKC3" alt="codecov"></a></li>
<li><a href="https://CRAN.R-project.org/package=rgeedim" class="external-link"><img src="https://www.r-pkg.org/badges/version-last-release/rgeedim" alt="CRAN status"></a></li>
<li><a href="https://app.codecov.io/gh/brownag/rgeedim" class="external-link"><img src="https://codecov.io/gh/brownag/rgeedim/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Andrew Brown.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
